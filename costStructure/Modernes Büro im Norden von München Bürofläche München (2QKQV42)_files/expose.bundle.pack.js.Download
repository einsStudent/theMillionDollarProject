var __extends=this&&this.__extends||function(){var a=function(c,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(c,a){for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b]};return a(c,b)};return function(c,b){a(c,b);function d(){this.constructor=c}c.prototype=b===null?Object.create(b):(d.prototype=b.prototype,new d)}}(),IwAG;(function(a){var b=function(){function a(){this._observers=[]}a.prototype.RegisterObserver=function(a){this._observers.push(a)};a.prototype.RemoveObserver=function(a){this._observers.splice(this._observers.indexOf(a),1)};a.prototype.InitializeObservers=function(c,a,b){this._observers.forEach(function(d){d.OnDocumentReady(c,a,b)})};a.prototype.NotifyObservers=function(a){this._observers.forEach(function(b){b.Update(a)})};return a}(),c=function(){function a(){}a.prototype.OnDocumentReady=function(c,a,b){this.Jq=c;this.Wnd=b;this.GlobalVars=a};a.prototype.Update=function(){};return a}();a.BaseClass=c;if(typeof a==="undefined")throw new Error("Error: IwAG not present!");if(typeof a.$==="undefined")throw new Error("Error: IwAG.$ not present!");if(typeof a.Vars==="undefined")throw new Error("Error: IwAG.Vars not present!");if(typeof a.Container==="undefined"||a.Container==null){a.Container=new b;a.$(function(){a.Container.InitializeObservers(a.$,a.Vars,window)})}})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(c){var b=function(c){__extends(b,c);function b(e,d,b){var a=c.call(this)||this;a.hiddenCss="display_none";a.divContact=null;a.buttonContactAddress=null;a.divContactAddress=null;a.buttonLogin=null;a.buttonOpenContactForm=null;a.buttonOpenContactFormNoPic=null;a.buttonCloseContactForm=null;a.textboxAddress=null;a.textAreaAnnotation=null;a.inputFirstName=null;a.inputLastName=null;a.inputCompany=null;a.inputContactPerson=null;a.dropDownSalutation=null;a.buttonContactSend=null;a.buttonStepForward=null;a.buttonStepBackward=null;a.labelDatenschutzhinweis=null;a.pages=null;a.activePageIndex=0;a.lastSalutation=null;a.lastGeneratedAnnotation=null;a.hiddenBackLink=null;a.hiddenRefreshContactForm=null;a.bRefreshContactForm=false;a.checkBoxWantToView=null;a.checkBoxWantInformation=null;a.checkBoxWantCallBack=null;a.checkBoxesAnnotation=null;a.customUserTextAnnotation=false;a.isSDevice=false;a.contentDivPositions=[];a.contentDivs=null;a.statusContainer=null;a.statusContainerHeight=0;a.contactPresets=[];a.estateGuid=null;a.counterSend=0;a.OnDocumentReady(e,b,d);return a}b.prototype.OnDocumentReady=function(f,d,e){var b=this;c.prototype.OnDocumentReady.call(this,f,d,e);this.divContact=this.Jq("#divContact");if(this.divContact.length===0)return;a.Base.getInstance().addAsyncLoaded(function(){b.Bind();b.BindEvents()});this.SetContactParams();this.modifyDisplayControls()};b.prototype.Bind=function(){this.isSDevice=a.Vars.DeviceType==="mobile";this.buttonOpenContactForm=this.Jq(".js-OpenContact");this.buttonOpenContactFormNoPic=this.Jq(".js-OpenContactNoPic");this.buttonCloseContactForm=this.Jq("#closecontactform");this.buttonLogin=this.Jq(".js-ContactLogin");this.buttonContactAddress=this.Jq("#aKontaktadresse");this.hiddenBackLink=this.Jq(".js-endlink-input");this.hiddenRefreshContactForm=this.Jq("#hidRefreshContactForm");this.bRefreshContactForm=this.hiddenRefreshContactForm.length?this.hiddenRefreshContactForm.val()==="true":false;this.checkBoxWantToView=this.Jq("#requestViewing");this.checkBoxWantInformation=this.Jq("#requestMoreInformation");this.checkBoxWantCallBack=this.Jq("#requestCallback");this.checkBoxesAnnotation=this.Jq(".horizontal_check");this.contentDivs=this.Jq(".expose > div").not("#divContact");this.statusContainer=this.Jq("#statusBar");this.statusContainerHeight=this.statusContainer.height();this.estateGuid=this.Jq("#EstateGuid").val();this.textboxAddress=this.Jq("#street,#zipcode,#city");this.textAreaAnnotation=this.Jq("#message");this.inputFirstName=this.Jq("#firstname");this.inputLastName=this.Jq("#lastname");this.inputCompany=this.Jq("#firmname");this.inputContactPerson=this.Jq("#contactPerson");this.dropDownSalutation=this.Jq("#salutation");this.lastSalutation=this.dropDownSalutation.val();this.buttonContactSend=this.Jq("#btnContactSend");this.buttonStepForward=this.Jq("#btnStepForward");this.buttonStepBackward=this.Jq("#btnStepBack");this.labelDatenschutzhinweis=this.Jq("#lblDatenschutzhinweis");this.pages=this.Jq(".js-page");if(this.pages.length>1){this.buttonContactSend.addClass(this.hiddenCss);this.buttonStepForward.removeClass(this.hiddenCss);this.labelDatenschutzhinweis.addClass(this.hiddenCss)}this.defaultRegexValidatorFunction=this.Jq.validator.messages.regex};b.prototype.BindEvents=function(){var b=this;this.buttonLogin.on("click",function(){b.setHiddenBackLink()});this.buttonContactAddress.off("click").on("click",function(a){b.contactAdressHandler();a.preventDefault();return false});this.buttonOpenContactForm.off("click").on("click",function(a){b.displayContactForm();b.hideAnbieterContactForm();a.preventDefault();return false});this.buttonOpenContactFormNoPic.off("click").on("click",function(){b.hideAnbieterContactForm();b.displayContactForm()});this.buttonCloseContactForm.off("click").on("click",function(c){var a=b.Jq(c.target);a.parents(".section").addClass(b.hiddenCss);document.documentElement.style.position="static";b.resetValidationToDefault();b.refreshContactForm(a.data("url"))});this.buttonStepForward.off("click").on("click",function(){if(b.textAreaAnnotation.valid()){b.activePageIndex++;b.setPagingControls();b.trackKontaktAnfrMehrstufig("kontakt_email_mehrstufig","kontakt_email_schritt2")}});this.buttonStepBackward.off("click").on("click",function(){b.activePageIndex--;b.setPagingControls()});this.buttonContactSend.off("click").on("click",function(){a.Expose.getInstance().ScrollToElement(b.divContact);b.counterSend++;b.pages.length>2&&b.trackKontaktAnfrMehrstufig("kontakt_email_mehrstufig","kontakt_email_absenden")});this.divContact.find("form").on("submit",function(a){if(b.Jq(a.target).valid()){b.Jq("#contactLoader").removeClass(b.hiddenCss);b.Jq("#formKontaktanfrage").css("opacity",.2)}return true});this.checkBoxesAnnotation.off("change").on("change",function(){!b.customUserTextAnnotation&&b.setAnnotationText()});this.inputContactPerson.off("keyup change").on("keyup change",function(){b.inputLastName.val(b.inputContactPerson.val())});this.inputCompany.off("keyup change").on("keyup change",function(){b.inputFirstName.val(b.inputCompany.val())});this.textAreaAnnotation.on("blur",function(){b.validateAnnotation()}).on("keypress",function(){b.customUserTextAnnotation=true});this.dropDownSalutation.off("change").on("change",function(){b.onSalutationChange();b.trackGender(b.dropDownSalutation.val())});this.Jq(window).on("orientationchange",function(){!b.Jq("div#div_contact").hasClass(b.hiddenCss)&&b.buttonCloseContactForm.click()})};b.prototype.BindValidator=function(){var b=this,a=this.divContact.find("form").data("validator");if(!a||!this.textAreaAnnotation.length)return;this.textAreaAnnotation.rules("add",{required:true,pattern:/^(?![\s\S]*[<>])[\s\S]*/i,messages:{pattern:'Die Zeichen "< und >" dürfen nicht in Ihrer Anfrage enthalten sein.',required:"Die Nachricht an den Anbieter darf nicht leer sein."}});this.Jq.validator.addMethod("regex",function(c,b,a){if(this.optional(b))return true;if(typeof a==="string")a=new RegExp("^(?:"+a+")$");return a.test(c)},function(e,d){var c=b.Jq('label[for="'+d.id+'"]'),a=c.data("label");if(a)a=' im Feld "'+a+'"';return"Bitte geben Sie einen gültigen Wert"+a+" ein."})};b.prototype.DisplayWithPreset=function(a){this.contactPresets=[a];this.setContactText();this.displayContactForm()};b.prototype.setPagingControls=function(){this.pages.addClass(this.hiddenCss).eq(this.activePageIndex).removeClass(this.hiddenCss);this.buttonContactSend.addClass(this.hiddenCss);this.buttonStepBackward.addClass(this.hiddenCss);this.buttonStepForward.addClass(this.hiddenCss);this.labelDatenschutzhinweis.addClass(this.hiddenCss);if(this.activePageIndex===0)this.buttonStepForward.removeClass(this.hiddenCss);else if(this.activePageIndex===this.pages.length-1){this.buttonContactSend.removeClass(this.hiddenCss);this.buttonStepBackward.removeClass(this.hiddenCss);this.labelDatenschutzhinweis.removeClass(this.hiddenCss)}else{this.buttonStepForward.removeClass(this.hiddenCss);this.buttonStepBackward.removeClass(this.hiddenCss)}};b.prototype.displayContactForm=function(){this.onSalutationChange();this.BindValidator();var c=window.pageYOffset||document&&document.documentElement.scrollTop,b=3,d=3;if(this.isSDevice){this.divContact.find(".js-trackKontaktMehrst").length>0&&this.trackKontaktAnfrMehrstufig("kontakt_email_mehrstufig","kontakt_email_schritt1");this.checkDisplaySettings();a.Expose.getInstance().DisplaySectionContact(this.divContact,true);return false}if(this.contentDivPositions.length===0){var e=[];this.contentDivs.each(function(b,a){e.push(a.offsetTop)});this.contentDivPositions=e}if(!this.divContact.hasClass(this.hiddenCss)&&this.divContact.offset().top-c<0)c-=this.divContact.outerHeight(true)-15;for(;d<this.contentDivPositions.length;d++){if(this.contentDivPositions[d]>=c+this.statusContainerHeight){b=d;break}if(d===this.contentDivPositions.length-1)b=d}if(b>1&&this.contentDivPositions[b]>c+window.innerHeight&&Math.abs(this.contentDivPositions[b]-c)>Math.abs(this.contentDivPositions[b-1]-c))b--;this.divContact.find(".js-trackKontaktMehrst").length>0&&this.trackKontaktAnfrMehrstufig("kontakt_email_mehrstufig","kontakt_email_schritt1");this.divContact.addClass(this.hiddenCss).detach();this.Jq("html body").scrollTop(c);this.divContact.insertBefore(this.contentDivs[b]);this.checkDisplaySettings();a.Expose.getInstance().DisplaySectionContact(this.divContact,false);a.Expose.getInstance().trackExposeInteraction("openContactForm",1);a.Expose.getInstance().hideNotificationPopup();return false};b.prototype.checkDisplaySettings=function(){if(this.textAreaAnnotation.val()==""&&this.counterSend>0){this.setAnnotationText();this.modifyDisplayControls();this.activePageIndex--}};b.prototype.hideAnbieterContactForm=function(){this.Jq(".section_anbieterkontaktanfrage").hide()};b.prototype.SetContactParams=function(){var e=String.GetUrlParam(window.location.href,"nopics"),c=String.GetUrlParam(window.location.href,"nolocation"),d=String.GetUrlParam(window.location.href,"noprice"),b=String.GetUrlParam(window.location.href,"minimumprice"),a=window.location.hash==="#kontaktanfrage"||String.GetUrlParam(window.location.href,"syscid")==="erneute_anfrage";e==="1"&&this.contactPresets.push("nopics");c==="1"&&this.contactPresets.push("nolocation");d==="1"&&this.contactPresets.push("noprice");b==="1"&&this.contactPresets.push("minimumprice");if(this.contactPresets.length>0)this.setContactText();else this.setAnnotationText();(this.contactPresets.length>0||a)&&this.displayContactForm()};b.prototype.refreshContactForm=function(c){var b=this;if(!this.bRefreshContactForm)return;this.Jq.ajax({type:"GET",cache:false,url:c,success:function(f){var c=b.Jq(f).filter("[data-result=async]");if(!c.length)c=b.Jq(f).find("[data-result=async]").first();if(c.length){var e=b.Jq("#formKontaktanfrage"),d=e.filter("[data-result=async]");if(!d.length)d=e.find("[data-result=async]").first();d.replaceWith(c)}a.Base.getInstance().executeAsyncLoaded()}})};b.prototype.contactAdressHandler=function(){var a="Meine Adresse ";if(this.divContactAddress.hasClass(this.hiddenCss)){this.divContactAddress.removeClass(this.hiddenCss);a+="entfernen"}else{this.divContactAddress.addClass(this.hiddenCss);this.textboxAddress.val("");a+="angeben"}this.buttonContactAddress.text(a)};b.prototype.setContactText=function(){var a="Ich interessiere mich für Ihr Angebot. Bitte nehmen Sie Kontakt mit mir auf";if(this.contactPresets.length===0){this.textAreaAnnotation.val(a+".");return}a+=this.contactPresets.length===1?" und":",";for(var c=false,b=0;b<this.contactPresets.length;b++){switch(this.contactPresets[b]){case"visit":a+=" nennen Sie mir einen passenden Besichtigungstermin";break;case"nolocation":a+=" teilen Sie mir die genaue Anschrift mit";break;case"nopics":a+=" schicken Sie mir Bilder zu";break;case"noprice":a+=" nennen Sie mir den aktuellen Preis";break;case"minimumprice":a="Ich interessiere mich für Ihr Angebot und möchte Ihnen ein Angebot für die Immobilie machen";c=true}if(c){this.addToLinkPreset(this.contactPresets[b]);break}if(b===this.contactPresets.length-2)a+=" und";else if(b!==this.contactPresets.length-1)a+=",";this.addToLinkPreset(this.contactPresets[b])}a+=".";this.textAreaAnnotation.val(a)};b.prototype.addToLinkPreset=function(a){if(String.GetUrlParam(window.location.href,"mode")!=="light")return;var b=this.hiddenBackLink.val().indexOf("?")>-1?"&":"?";this.hiddenBackLink.val().indexOf(a)<0&&this.hiddenBackLink.val(this.hiddenBackLink.val()+b+a+"=1")};b.prototype.setHiddenBackLink=function(){if(this.hiddenBackLink.val().indexOf("erneute_anfrage")>=0)return;var a=this.hiddenBackLink.val();a+=a.indexOf("?")>-1?"&":"?";a+="syscid=erneute_anfrage";this.hiddenBackLink.val(a)};b.prototype.setAnnotationText=function(){var a=0;if(this.checkBoxWantToView.is(":checked"))a+=4;if(this.checkBoxWantInformation.is(":checked"))a+=2;if(this.checkBoxWantCallBack.is(":checked"))a+=1;this.replaceAnnotationValuesAndKeepUserInput(this.getAnnotationValues(a))};b.prototype.onSalutationChange=function(){var a=this.dropDownSalutation.val();if(a==="Firma"){if(this.lastSalutation){this.inputFirstName.val("");this.inputLastName.val("")}this.setVisible(this.inputCompany,true);this.setVisible(this.inputContactPerson,true);this.setVisible(this.inputFirstName,false);this.setVisible(this.inputLastName,false)}else{if(this.lastSalutation==="Firma"){this.inputFirstName.val("");this.inputLastName.val("");this.inputCompany.val("");this.inputContactPerson.val("")}this.setVisible(this.inputFirstName,true);this.setVisible(this.inputLastName,true);this.setVisible(this.inputCompany,false);this.setVisible(this.inputContactPerson,false)}this.lastSalutation=a};b.prototype.setVisible=function(b,c){var a=b.parent("div");if(c)a.removeClass(this.hiddenCss);else a.addClass(this.hiddenCss)};b.prototype.replaceAnnotationValuesAndKeepUserInput=function(a){var b=this.textAreaAnnotation.val();if(this.lastGeneratedAnnotation!=null){var c=b.replace(this.lastGeneratedAnnotation,a);if(c===b)if(b==="")this.textAreaAnnotation.val(a);else this.textAreaAnnotation.val(b+"\r\n"+a);else this.textAreaAnnotation.val(c)}else this.textAreaAnnotation.val(a);this.lastGeneratedAnnotation=a};b.prototype.getAnnotationValues=function(f){var a="Ich interessiere mich für Ihr Angebot",b=" und möchte gerne einen Besichtigungstermin vereinbaren.",c=" Bitte rufen Sie mich zurück",d=" Bitte nehmen Sie Kontakt mit mir auf",e=" und senden Sie mir weitere Informationen zum Objekt.";switch(f){case 0:return a+"."+d+".";case 1:return a+"."+c+".";case 2:return a+"."+d+e;case 3:return a+"."+c+e;case 4:return a+b+d+".";case 5:return a+b+c+".";case 6:return a+b+d+e;case 7:return a+b+c+e}return""};b.prototype.validateAnnotation=function(){var a=/<.*>/;if(a.test(this.textAreaAnnotation.val()))this.textAreaAnnotation.addClass("error");else this.textAreaAnnotation.removeClass("error")};b.prototype.trackKontaktAnfrMehrstufig=function(a,b){typeof utag!=="undefined"&&utag.link({event_category:a,event_action:"click",event_label:b})};b.prototype.trackGender=function(b){if(typeof utag!=="undefined"){if(!b)return;var a="";if(b.indexOf("Herr")>-1)a="maennlich";else if(b.indexOf("Frau")>-1)a="weiblich";else return;utag.link({customer_gender:a,event_category:"button-intern",event_action:"click",event_label:"formular_anrede"})}};b.prototype.modifyDisplayControls=function(){var d=this,a=this.Jq("#srcLabelMessage");a.length&&this.Jq("#lblmessage").text(a.text());var c=this.textboxAddress.filter("[data-val-required]").length===0;if(c){this.divContactAddress=this.textboxAddress.closest(".js-group");this.buttonContactAddress.removeClass(this.hiddenCss).insertBefore(this.divContactAddress.addClass(this.hiddenCss));var b=this.textboxAddress.filter(function(b,a){return d.Jq(a).val()}).length>0;if(b){this.contactAdressHandler();this.buttonContactAddress.addClass("active")}}};b.prototype.resetValidationToDefault=function(){this.Jq.validator.messages.regex=this.defaultRegexValidatorFunction};return b}(a.BaseClass);c.Kontaktanfrage=b})(b=a.Expose||(a.Expose={}))})(IwAG||(IwAG={}));var System;(function(b){var a=function(){function a(a){this.days=a&&a.days?a.days:0;this.hours=a&&a.hours?a.hours:0;this.minutes=a&&a.minutes?a.minutes:0;this.seconds=a&&a.seconds?a.seconds:0}a.prototype.isPositive=function(){return this.days===0&&this.hours===0&&this.minutes===0&&this.seconds===0||this.days<0||this.hours<0||this.minutes<0||this.seconds<0?false:true};a.prototype.asMilliseconds=function(){return this.seconds*1e3+this.minutes*6e4+this.hours*36e5+this.days*864e5};return a}();b.TimeSpan=a})(System||(System={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(){function a(){this.cssClass="infobox";this.additionCssClasses=[]}a.prototype.hasPointer=function(){return false};a.prototype.getWidth=function(){return 340};a.prototype.getHtml=function(){var a=document.createElement("div");a.classList.add(this.cssClass);var b=document.createElement("h3");b.innerText=this.title;b.id="boxHeading";a.appendChild(b);var c=document.createElement("p");c.innerHTML=this.content;a.appendChild(c);return a};a.prototype.onClosed=function(){};return a}();a.InfoBox=b;var c=function(b){__extends(a,b);function a(c,d){var a=b.call(this)||this;a.map=d;a.timeout=c;return a}a.prototype.getHtml=function(){var c=this,a=b.prototype.getHtml.call(this);this.timeoutHandle=window.setTimeout(function(){return c.map.hideInfoBox()},this.timeout.asMilliseconds());return a};a.prototype.onClosed=function(){b.prototype.onClosed.call(this);window.clearTimeout(this.timeoutHandle)};return a}(b);a.SelfClosingInfoBox=c;var d=function(b){__extends(a,b);function a(g,e){var a=b.call(this)||this;a._buttons=[];a.map=g;for(var c=0,d=e;c<d.length;c++){var f=d[c];a._buttons.push(f)}return a}a.prototype.getHtml=function(){var a=document.createElement("div");a.classList.add(this.cssClass);var d=document.createElement("h3");d.innerText=this.title;d.id="boxHeading";a.appendChild(d);var g=document.createElement("p");g.innerText=this.content;a.appendChild(g);for(var e=0,h=this._buttons;e<h.length;e++){var c=h[e],f=document.createElement("div");f.className="h_010";a.appendChild(f);var b=document.createElement("a");b.id=c.id;b.className=c.class;b.innerText=c.innerText;b.addEventListener("click",c.onClickAction);a.appendChild(b)}return a};return a}(b);a.InfoBoxWithButton=d;var e=function(){function a(d,c,b,a){this.id=d;this.class=c;this.innerText=b;this.onClickAction=a}return a}();a.InfoBoxButton=e})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(b){var c;(function(b){var c=function(b){__extends(a,b);function a(d,c){var a=b.call(this)||this;a.map=d;a.position=c;return a}a.prototype.getWidth=function(){return 260};a.prototype.hasPointer=function(){return true};a.prototype.openInfoBox=function(){this.map.showInfobox(this,this.position)};return a}(b.InfoBox);b.ToolTipInfoBox=c;var d=function(c){__extends(b,c);function b(f,d,b,e){var a=c.call(this,f,e)||this;a._guidList=d;a.objectInfoApiUrl=b;return a}b.prototype.openInfoBox=function(){var a=this;if(this.content==undefined)this.initializeToolTip().then(function(){a.map.showInfobox(a,a.position)});else this.map.showInfobox(this,this.position)};b.prototype.initializeToolTip=function(){var c=this,b=a.$.ajax({type:"POST",url:this.objectInfoApiUrl,contentType:"application/json",data:"{ 'id': '"+this._guidList.join(",")+"'}",dataType:"json",success:function(a){c.onPostSuccess(a)}});return b};b.prototype.onPostSuccess=function(a){if(a){if(a.d)a=JSON.parse(a.d);this.content=this.getToolTipDescription(a.o)}};b.prototype.getToolTipDescription=function(c){var g=c.length,b=0,d,e="";g>1&&this.additionCssClasses.push("cluster");for(;b<g;b++){d="";if(c[b].cit){var f=c[b].zip+" "+c[b].cit;if(c[b].district)f+=" ("+c[b].district+")";d+='<div class="city">'+f+"</div>"}if(c[b].price.length===2)d+='<div class="hardfact">'+c[b].price[0]+' <span class="hardfactlabel">'+c[b].price[1]+"</span></div>";var h=a.Vars.linkToDetail.indexOf("?id=")>=0?c[b].id:c[b].onlineId;e+='<a href="'+String.Format(a.Vars.linkToDetail,h)+'" class="item clear">\n                                <div class="listimage">\n                                    <img alt="" src= "'+this.getImagePath(c[b].thumb)+'" />\n                                </div>\n                                <div class="iw_left padding_left_10 map_listitem_wrap">\n                                    <h3>'+c[b].title+"</h3>\n                                    "+d+"\n                                </div>\n                            </a>"}return e};b.prototype.getImagePath=function(b){if(b.toLowerCase().indexOf("mid_{0}")>-1){b=String.Format(b,a.Vars.MediaId.toString());if(b.substring(0,1)==="~")b=b.substring(1)}return b};b.prototype.getHtml=function(){return this.content};return b}(c);b.EstateOfferInfoBox=d;var e=function(c){__extends(b,c);function b(f,d,b,e){var a=c.call(this,f,e)||this;a._guidList=d;a.objectInfoApiUrl=b;return a}b.prototype.openInfoBox=function(){var a=this;if(this.content==undefined)this.initializeToolTip().then(function(){a.map.showInfobox(a,a.position)});else this.map.showInfobox(this,this.position)};b.prototype.initializeToolTip=function(){var c=this,b=a.$.ajax({type:"POST",url:this.objectInfoApiUrl,contentType:"application/json",data:"{ 'guid': '"+this._guidList+"'}",dataType:"json",success:function(a){c.onPostSuccess(a)}});return b};b.prototype.onPostSuccess=function(a){if(a){if(a.d)a=JSON.parse(a.d);this.content=this.getToolTipDescription(a.o)}};b.prototype.getToolTipDescription=function(c){var g=c.length,b=0,d,e="";g>1&&this.additionCssClasses.push("cluster");for(;b<g;b++){d="";if(c[b].cit){var f=c[b].zip+" "+c[b].cit;if(c[b].district)f+=" ("+c[b].district+")";d+='<div class="city">'+f+"</div>"}var h=a.Vars.linkToDetail.indexOf("guid=")>=0?c[b].guid:c[b].onlineId;e+='<a href="'+String.Format(a.Vars.linkToDetail,c[b].guid)+'" class="item clear">\n                                <div class="immomakler-image padding_top_10 padding_bottom_10">\n                                    <img alt="" src= "'+this.getImagePath(c[b].thumb)+'" />\n                                </div>\n                                <div class="iw_left padding_left_10 map_listitem_wrap">\n                                    <h3>'+c[b].title+"</h3>\n                                    "+d+"\n                                </div>\n                            </a>"}return e};b.prototype.getImagePath=function(b){if(b.toLowerCase().indexOf("mid_{0}")>-1){b=String.Format(b,a.Vars.MediaId.toString());if(b.substring(0,1)==="~")b=b.substring(1)}return b};b.prototype.getHtml=function(){return this.content};return b}(c);b.BrokersInfoBox=e})(c=b.DataContracts||(b.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(){function a(c,b,a){this.eventListenersOnHover=[];this.eventListenersOnHoverEnd=[];this.eventListenersOnClick=[];this.map=c;this.infoBox=b;this.getIcon=a}a.prototype.onHover=function(){var a=this;this.eventListenersOnHover.forEach(function(b){return b(a,{coordinates:a.position})})};a.prototype.onHoverEnd=function(){var a=this;this.eventListenersOnHoverEnd.forEach(function(b){return b(a,{coordinates:a.position})})};a.prototype.onClick=function(){var a=this;this.map.hideInfoBox();if(this.getIcon){this.icon=this.getIcon(this.isClustered,this.isRemembered,true);this.map.setMarkerOptions(this)}this.infoBox&&this.infoBox.openInfoBox();this.eventListenersOnClick.forEach(function(b){return b(a,{coordinates:a.position})})};a.prototype.unselect=function(){if(this.getIcon){this.icon=this.getIcon(this.isClustered,this.isRemembered,false);this.map.setMarkerOptions(this)}};a.prototype.addListener=function(c,b){var a=0;switch(c){case"mouseover":this.eventListenersOnHover.push(b);a=this.eventListenersOnHover.length-1;break;case"mouseout":this.eventListenersOnHoverEnd.push(b);a=this.eventListenersOnHoverEnd.length-1;break;case"click":this.eventListenersOnClick.push(b);a=this.eventListenersOnClick.length-1}return a};return a}();a.PushPin=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(){function a(){this.id=0}return a}();a.Geometry=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(c){__extends(b,c);function b(){return c!==null&&c.apply(this,arguments)||this}b.prototype.getReducedPoints=function(b){return(new a.DouglasPeuckerAlgorithm).Reduce(this.points,b)};return b}(a.Geometry);a.Polyline=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(b){var a=function(){function a(){}a.prototype.Reduce=function(a,c){var b=null;if(a.length){b=this.arrayAlgorithm(a,c);b.push(a[a.length-1])}return b};a.prototype.arrayAlgorithm=function(a,g){if(a.length<=2)return[a[0]];var b=[],f=0,c=0,e;this.point1=a[0];this.point2=a[a.length-1];for(var d=1;d<=a.length-2;d++){var h=this.distanceToPoint(a[d]);if(h>f){f=h;c=d}}if(f>=g){e=a[c];this.distanceToPoint(e);b=b.concat(this.arrayAlgorithm(a.slice(0,c+1),g));b=b.concat(this.arrayAlgorithm(a.slice(c,a.length),g))}else{e=a[c];this.distanceToPoint(e);b=[a[0]]}return b};a.prototype.distanceToPoint=function(a){var c=(this.point2.latitude-this.point1.latitude)/(this.point2.longitude-this.point1.longitude),d=this.point1.latitude-c*this.point1.longitude,b=[];b.push(Math.abs(a.latitude-c*a.longitude-d)/Math.sqrt(Math.pow(c,2)+1));b.push(Math.sqrt(Math.pow(a.longitude-this.point1.longitude,2)+Math.pow(a.latitude-this.point1.latitude,2)));b.push(Math.sqrt(Math.pow(a.longitude-this.point2.longitude,2)+Math.pow(a.latitude-this.point2.latitude,2)));return b.sort(function(a,b){return a-b})[0]};return a}();b.DouglasPeuckerAlgorithm=a})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(c){__extends(b,c);function b(b){var a=c.call(this)||this;a.paths=[];if(b)a.paths=a.parseWKT(b);return a}b.prototype.getReducedPoints=function(b){return(new a.DouglasPeuckerAlgorithm).Reduce(this.points,b)};b.prototype.parseWKT=function(i){var c,b,g,h,d=i.match(/\([^\(\)]+\)/g),a,f=[],e=[];if(d)for(c=0;c<d.length;c++){a=d[c].match(/-?\d+\.?\d*/g);if(a){for(b=0;b<a.length;b+=2){h=Number(a[b]);g=Number(a[b+1]);e.push({latitude:g,longitude:h})}f.push(e)}}return f};b.prototype.getWellKnownText=function(){var a="POLYGON(";if(this.paths.length>0)for(var c=0;c<this.paths.length;c++){var b=this.paths[c];a+="(";for(var d=0;d<b.length;d++)a+=b[d].longitude+" "+b[d].latitude+",";a+=b[c].longitude+" "+b[c].latitude+"),"}a=a.substring(0,a.length-1)+")";return a};return b}(a.Geometry);a.Polygon=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(){function a(c,a,b){this._center=c;this._northEast=a;this._southWest=b}a.prototype.contains=function(a){return this._northEast.latitude>a.latitude&&this._northEast.longitude>a.longitude&&this._southWest.latitude<a.latitude&&this._southWest.longitude<a.longitude};return a}();a.Bounds=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(b){__extends(a,b);function a(c,d){var a=b.call(this)||this;a.boundEvents=[];a.centerPoint=c;a.radius=d;return a}Object.defineProperty(a.prototype,"center",{"get":function(){return this.centerPoint},"set":function(a){var b=this;this.centerPoint=a;this.boundEvents.filter(function(a){return a.event==="dragend"}).forEach(function(a){return a.handler({center:b.centerPoint})})},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"radius",{"get":function(){return this.radiusValue},"set":function(a){var b=this;this.radiusValue=a;this.boundEvents.filter(function(a){return a.event==="radius_changed"}).forEach(function(a){return a.handler({radius:b.radiusValue})})},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"isEditable",{"get":function(){return this.editable},"set":function(a){this.editable=a},enumerable:true,configurable:true});a.prototype.addListener=function(c,b){var a=this.boundEvents.length;this.boundEvents[a]={event:c,handler:b};return a};a.prototype.removeListener=function(a){this.boundEvents[a]={event:"noop",handler:function(){}}};a.prototype.resetRadius=function(a){this.radius=a};return a}(a.Geometry);a.Circle=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var c;(function(a){a[a.satellite=0]="satellite";a[a.road=1]="road";a[a.hybrid=2]="hybrid"})(c=a.MapTypes||(a.MapTypes={}));var b;(function(a){a[a.fixed=0]="fixed";a[a.fullcontrolled=1]="fullcontrolled";a[a.automatic=2]="automatic"})(b=a.MapGestureHandling||(a.MapGestureHandling={}))})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(c){var d=function(){function a(c,d,e){this.boundEvents=[];this._markers=[];this._polygons=[];this._polylines=[];this._internalPolyline=new google.maps.Polyline;var a=b.iwagMapOptionsToGoogleMpOptions(d);a.fullscreenControl=false;a.styles=[{featureType:"poi",stylers:[{visibility:"off"}]}];this._internalMap=new google.maps.Map(document.getElementById(c),a);this._mapKey=e;this._infobox={googleInfoBox:new InfoBox,IwAGInfoBox:null}}Object.defineProperty(a.prototype,"mapKey",{"get":function(){return this._mapKey},enumerable:true,configurable:true});a.prototype.refreshMap=function(){google.maps.event.trigger(this._internalMap,"resize")};a.prototype.addGeometry=function(){};a.prototype.removeGeometry=function(){throw new Error("Not implemented");};a.prototype.addPushpin=function(a){var e=this,d={position:b.iwAgCoordinatesToGoogleLatLng(a.position),map:this._internalMap,icon:a.icon,optimized:true,title:a.title,zIndex:150+this._markers.length};if(a.label!=undefined)d.label={text:a.label,color:"#FFFFFF",fontWeight:"bold"};var c=new google.maps.Marker(d);c.addListener("mouseover",function(){return a.onHover&&a.onHover()});c.addListener("mouseout",function(){return a.onHoverEnd&&a.onHoverEnd()});c.addListener("click",function(){e._markers.forEach(function(a){a.pushPin.unselect()});a.onClick()});this._markers.push({pushPin:a,marker:c})};a.prototype.removePushpin=function(b){var a=this._markers.filter(function(a){return a.pushPin===b})[0];a&&a.marker.setMap(null)};a.prototype.centerView=function(a){this._internalMap.setCenter(b.iwAgCoordinatesToGoogleLatLng(a))};a.prototype.fitBounds=function(c,d){var e=this,a,f=jQuery.Deferred(function(j){if(c.polygon){var i=[],h=[-180,-90,90,180];c.polygon.paths.forEach(function(a){a.forEach(function(a){if(h.indexOf(a.latitude)>-1||h.indexOf(a.longitude)>-1)return;i.push(a)})});a=e.getBoundsFromCoordinates(i)}else if(c.circle){var k=new google.maps.Circle({center:new google.maps.LatLng(c.circle.center.latitude,c.circle.center.longitude),radius:c.circle.radius*1e3});a=e.getBoundsFromCircle(k)}else if(c.pushpins)a=e.getBoundsFromCoordinates(c.pushpins.map(function(a){return a.position}));if(d){var f=a.getNorthEast(),g=a.getSouthWest(),l=Math.abs(f.lat()-g.lat()),m=Math.abs(f.lng()-g.lng());if(l<d||m<d){a.extend(new google.maps.LatLng(f.lat()-d,f.lng()+d));a.extend(new google.maps.LatLng(g.lat()+d,g.lng()-d))}}if(a){var n=e._internalMap.addListener("bounds_changed",function(){var c=a.getCenter();j.resolve(b.googleToIwAgCoordinates(c));n.remove()});e._internalMap.fitBounds(a)}else{var o=e._internalMap.getCenter();j.resolve(b.googleToIwAgCoordinates(o))}});return f};a.prototype.showInfobox=function(c,h){var i=this,g=c.getWidth(),e=c.getHtml(),a=document.createElement("div");a.classList.add("infoBox");c.additionCssClasses.forEach(function(b){return a.classList.add(b)});var d;if(e instanceof Node){d=document.createElement("span");d.classList.add("icon-close");a.appendChild(d);a.appendChild(e)}else{a.innerHTML='<span class="icon-close"></span>'+e;d=a.firstChild}this._infobox.googleInfoBox.setOptions({disableAutoPan:false,content:a,boxStyle:{background:"#fff",width:g+"px"},boxClass:"infoBoxWrapper"+(c.hasPointer()?" pointer":""),maxWidth:0,infoBoxClearance:new google.maps.Size(20,60),pane:"floatPane",alignBottom:true,pixelOffset:new google.maps.Size(g*-.5,-40),visible:true,closeBoxURL:""});google.maps.event.addDomListener(d,"click",function(){i.hideInfoBox();i.unselectMarker()});var f;if(h)f=b.iwAgCoordinatesToGoogleLatLng(h);else f=this._internalMap.getCenter();this._infobox.googleInfoBox.setPosition(f);this._infobox.googleInfoBox.open(this._internalMap);this._infobox.IwAGInfoBox=c};a.prototype.setMarkerOptions=function(a){var c={position:b.iwAgCoordinatesToGoogleLatLngLiteral(a.position),icon:a.icon};if(a.label!=undefined)c.label={text:a.label,color:"#FFFFFF",fontWeight:"bold"};var d=this._markers.filter(function(b){return b.pushPin===a})[0];d.marker.setOptions(c)};a.prototype.hideInfoBox=function(){if(this._infobox!==undefined&&this._infobox!==null){this._infobox.googleInfoBox!==undefined&&this._infobox.googleInfoBox!==null&&this._infobox.googleInfoBox.close();this._infobox.IwAGInfoBox!==undefined&&this._infobox.IwAGInfoBox!==null&&this._infobox.IwAGInfoBox.onClosed()}};a.prototype.getZoomLevel=function(){return this._internalMap.getZoom()};a.prototype.getCenterCoordinates=function(){return b.googleToIwAgCoordinates(this._internalMap.getCenter())};a.prototype.getBounds=function(){return b.googleToIwAgBounds(this._internalMap.getBounds())};a.prototype.getWidth=function(){return this._internalMap.getDiv().clientWidth};a.prototype.getHeight=function(){return this._internalMap.getDiv().clientHeight};a.prototype.unselectMarker=function(){var b=this,a=this._markers.filter(function(a){return a.pushPin.infoBox===b._infobox.IwAGInfoBox})[0];a!=undefined&&a.pushPin.unselect()};a.prototype.setOptions=function(a){this._internalMap.setOptions(b.iwagMapOptionsToGoogleMpOptions(a))};a.prototype.hidePushpins=function(){if(!this._markers.length)return;for(var a=0,b=this._markers.map(function(a){return a.marker});a<b.length;a++){var c=b[a];c.setVisible(false)}};a.prototype.showPushpins=function(){if(!this._markers.length)return;for(var a=0,b=this._markers.map(function(a){return a.marker});a<b.length;a++){var c=b[a];c.setVisible(true)}};a.prototype.clearPushpins=function(){if(!this._markers.length)return;for(var a=0,b=this._markers.map(function(a){return a.pushPin});a<b.length;a++){var c=b[a];this.removePushpin(c)}};a.prototype.addPolygon=function(a){if(!a.paths.length)return;a.id=this._polygons.length;var c=b.iwAGPolygonToGooglePolygon(a);c.setMap(this._internalMap);this._polygons.push(c)};a.prototype.removePolygon=function(a){var c=b.iwAGPolygonToGooglePolygon(a);this._polygons[a.id].setMap(null);this._polygons[a.id]=null};a.prototype.addListener=function(g,d){var c=this,a,e=function(a){return{coordinates:b.googleToIwAgCoordinates(a.latLng),pixelPosition:c.getPixelFromLatLng(a.latLng)}};switch(g){case"click":a=this._internalMap.addListener("click",function(a){d(c,e(a))});break;case"mousedown":a=this._internalMap.addListener("mousedown",function(a){d(c,e(a))});break;case"mousemove":a=this._internalMap.addListener("mousemove",function(a){d(c,e(a))});break;case"mouseup":a=this._internalMap.addListener("mouseup",function(a){d(c,e(a))});break;case"dragstart":a=this._internalMap.addListener("dragstart",function(a){d(c,a)});break;case"dragend":a=this._internalMap.addListener("dragend",function(a){d(c,a)});break;case"zoom_changed":a=this._internalMap.addListener("zoom_changed",function(a){d(c,a)});break;case"center_changed":a=this._internalMap.addListener("center_changed",function(a){d(c,a)});break;default:return-1}var f=this.boundEvents.length;this.boundEvents[f]=a;return f};a.prototype.removeListener=function(a){a>-1&&this.boundEvents[a].remove()};a.prototype.setPolygonOptions=function(a){if(!a)throw"Add polygon to map to set any options.";var b={fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,visible:a.visible};this._polygons[a.id].setOptions(b)};a.prototype.getPolygonCenter=function(d){var a=this._polygons[d.id],b=new google.maps.LatLngBounds;a&&a.getPaths().forEach(function(a){a.forEach(function(a){b.extend(a)})});var c=b.getCenter();return{latitude:c.lat(),longitude:c.lng()}};a.prototype.addCircle=function(a){var d=this,e={center:b.iwAgCoordinatesToGoogleLatLng(a.center),radius:a.radius,draggable:a.draggable,editable:a.isEditable,fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,visible:a.visible};this._circle=new google.maps.Circle(e);var c=true;this._circle.addListener("dragstart",function(){c=false});this._circle.addListener("dragend",function(){c=true;a.center=b.googleToIwAgCoordinates(d._circle.getCenter())});this._circle.addListener("center_changed",function(){if(c)a.center=b.googleToIwAgCoordinates(d._circle.getCenter())});this._circle.addListener("radius_changed",function(){a.radius=d._circle.getRadius()/1e3});this._circle.setMap(this._internalMap)};a.prototype.setCircleOptions=function(a){if(!this._circle)throw"Add circle to map to set any options.";var c={center:b.iwAgCoordinatesToGoogleLatLng(a.center),radius:a.radius*1e3,draggable:a.draggable,editable:a.isEditable,fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,visible:a.visible};this._circle.setOptions(c)};a.prototype.getBoundsFromCircle=function(a){return a.getBounds()};a.prototype.getBoundsFromCoordinates=function(b){var a=new google.maps.LatLngBounds;b.forEach(function(b){a.extend(new google.maps.LatLng(b.latitude,b.longitude))});return a};a.prototype.addPolyline=function(a){if(!a)return;a.id=this._polylines.length;this._internalPolyline=new google.maps.Polyline({path:a.points.map(function(a){return b.iwAgCoordinatesToGoogleLatLngLiteral(a)}),strokeColor:a.colour,strokeWeight:a.width,clickable:false});this._internalPolyline.setMap(this._internalMap);this._polylines.push(this._internalPolyline)};a.prototype.updatePolyline=function(a){var c=a.points.map(function(a){return b.iwAgCoordinatesToGoogleLatLng(a)});this._internalPolyline.setPath(c)};a.prototype.removePolyline=function(){this._polylines.remove(this._internalPolyline);this._internalPolyline.setMap(null);this._internalPolyline=new google.maps.Polyline};a.prototype.getPixelFromLatLng=function(e){var a=this._internalMap.getProjection();if(!a)return b.googleLatLngToGooglePixel(e);var g=Math.pow(2,this.getZoomLevel()),f=a.fromLatLngToPoint(e),d=this._internalMap.getBounds(),c=a.fromLatLngToPoint(new google.maps.LatLng(d.getNorthEast().lat(),d.getSouthWest().lng()));return new google.maps.Point(Math.floor((f.x-c.x)*g),Math.floor((f.y-c.y)*g))};a.prototype.calcAndDisplayRoute=function(a,b){var c=this;this.calcRoute(a,b,function(b,a){if(a===google.maps.DirectionsStatus.OK)c._directionsDisplay.setDirections(b);else throw"Could not display directions due to: "+a;})};a.prototype.hideRoute=function(){(this._directionsDisplay!=undefined||this._directionsDisplay!=null)&&this._directionsDisplay.set("directions",null)};a.prototype.calcRoute=function(b,c,a){this.initializeRouteService(b);this._directionService.route(c,a)};a.prototype.initializeRouteService=function(a){if(this._directionService==undefined||this._directionService==null||this._directionsDisplay==undefined||this._directionsDisplay==null){this._directionService=new google.maps.DirectionsService;this._directionsDisplay=new google.maps.DirectionsRenderer;this._directionsDisplay.setMap(this._internalMap);this._directionsDisplay.setPanel(a)}};return a}();c.GoogleMap=d;var b=function(){function b(){}b.iwAgCoordinatesToGoogleLatLngLiteral=function(a){return{lat:a.latitude,lng:a.longitude}};b.iwAgCoordinatesToGoogleLatLng=function(a){return new google.maps.LatLng(a.latitude,a.longitude)};b.googleToIwAgCoordinates=function(a){return a instanceof google.maps.LatLng?{latitude:a.lat(),longitude:a.lng()}:{latitude:a.lat,longitude:a.lng}};b.googleToIwAgBounds=function(c){return c instanceof google.maps.LatLngBounds?new a.DataContracts.Bounds(b.googleToIwAgCoordinates(c.getCenter()),b.googleToIwAgCoordinates(c.getNorthEast()),b.googleToIwAgCoordinates(c.getSouthWest())):new a.DataContracts.Bounds({latitude:0,longitude:0},{latitude:0,longitude:0},{latitude:0,longitude:0})};b.iwAGPolygonToGooglePolygon=function(a){return new google.maps.Polygon({paths:a.paths.map(function(a){return a.map(function(a){return b.iwAgCoordinatesToGoogleLatLngLiteral(a)})}),fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,visible:a.visible})};b.iwagMapOptionsToGoogleMpOptions=function(b){var c={};if(b.streetViewControl!==undefined&&b.streetViewControl!==null)c.streetViewControl=b.streetViewControl;if(b.mapTypeControl!==undefined&&b.mapTypeControl!==null)c.mapTypeControl=b.mapTypeControl;if(b.center!==undefined&&b.center!==null)c.center=new google.maps.LatLng(b.center.latitude,b.center.longitude);if(b.zoom!==undefined&&b.zoom!==null)c.zoom=b.zoom;if(b.clickableIcons!==undefined&&b.clickableIcons!==null)c.clickableIcons=b.clickableIcons;if(b.draggable!==undefined&&b.draggable!==null)c.draggable=b.draggable;if(b.draggableCursor!==undefined&&b.draggableCursor!==null)c.draggableCursor=b.draggableCursor;if(b.mapType!==undefined&&b.mapType!==null)switch(b.mapType){case a.DataContracts.MapTypes.road:c.mapTypeId=google.maps.MapTypeId.ROADMAP;break;case a.DataContracts.MapTypes.hybrid:c.mapTypeId=google.maps.MapTypeId.HYBRID;break;case a.DataContracts.MapTypes.satellite:c.mapTypeId=google.maps.MapTypeId.SATELLITE}if(b.gestureHandling!==undefined&&b.gestureHandling!==null)switch(b.gestureHandling){case a.DataContracts.MapGestureHandling.fixed:c.gestureHandling="none";break;case a.DataContracts.MapGestureHandling.fullcontrolled:c.gestureHandling="greedy"}return c};b.googleLatLngToGooglePixel=function(c){var b=256,a=Math.sin(c.lat()*Math.PI/180);a=Math.min(Math.max(a,-.9999),.9999);return new google.maps.Point(b*(.5+c.lng()/360),b*(.5-Math.log((1+a)/(1-a))/(4*Math.PI)))};return b}();c.GoogleMapHelpers=b})(b=a.Google||(a.Google={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(){function b(){this.geoCoder=new google.maps.Geocoder}b.prototype.findByCoordinates=function(a){return this.search(a)};b.prototype.findByAddress=function(a){return this.search(null,a)};b.prototype.search=function(f,d){if(d===void 0)d=null;var b={location:{latitude:0,longitude:0},formattedAddress:""},c=jQuery.Deferred(),e=null;if(f!=null)e=a.GoogleMapHelpers.iwAgCoordinatesToGoogleLatLng(f);this.geoCoder.geocode({address:d,location:e},function(d,e){if(e!==google.maps.GeocoderStatus.OK||d==null){c.resolve(b);return}var a=d[0];b={location:{latitude:a.geometry.location.lat(),longitude:a.geometry.location.lng()},formattedAddress:a.formatted_address};a.address_components.forEach(function(a){if(a.types.indexOf("street_number")>-1)b.streetnumber=a.long_name;else if(a.types.indexOf("route")>-1)b.street=a.long_name;else if(a.types.indexOf("locality")>-1)b.city=a.long_name;else if(a.types.indexOf("administrative_area_level_1")>-1)b.region=a.long_name;else if(a.types.indexOf("country")>-1)b.country=a.long_name;else if(a.types.indexOf("postal_code")>-1)b.zipcode=a.long_name});c.resolve(b)});return c};return b}();a.GoogleMapServices=b})(b=a.Google||(a.Google={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(b){var a=function(){function a(c,b,a){this.mapLoadCallbacks=[];this.Wnd=c;this.GlobalVars=b;this.mapKeyProvider=a}a.prototype.loadMap=function(){var a=this;this.mapKeyProvider.done(function(b){a.loadScripts(b)}).fail(function(){console.error("Error getting the MapKey!")})};a.prototype.addOnMapSourceLoadedCallback=function(a){this.mapLoadCallbacks.push(a)};a.prototype.createMap=function(){var a=this;this.mapLoadCallbacks.forEach(function(b){return b(a.mapKey)})};a.prototype.loadScripts=function(b){var c=this,a="GoogleMapLoaded";this.mapKey=b;this.Wnd[a]=function(){return c.loadPlugins()};var d="//maps.googleapis.com/maps/api/js?v=3&key="+b+"&callback="+a;this.addScriptTag(d,true)};a.prototype.loadPlugins=function(){var a=this,b=this.GlobalVars.IWhost+(this.GlobalVars.IWhost.endsWith("/")?"":"/")+"_scripts/mvc/_plugin/google.maps.infobox.js";this.addScriptTag(b,true,function(){return a.createMap()})};a.prototype.addScriptTag=function(c,d,b){var a=this.Wnd.document.createElement("script");a.src=c;a.type="text/javascript";a.async=d;a.charset="utf-8";if(b)a.onload=b;this.Wnd.document.getElementsByTagName("head")[0].appendChild(a);return a};return a}();b.GoogleMapLoader=a})(b=a.Google||(a.Google={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(b){__extends(a,b);function a(f,d,e,c){var a=b.call(this,f,c)||this;a._poiData=d;a._poiIcon=e;return a}a.prototype.openInfoBox=function(){this.content=this.getToolTipDescription();this.title=this.getTitle();this.map.showInfobox(this,this.position)};a.prototype.getToolTipDescription=function(){if(!this._poiData)return null;var a=this._poiData.address+"<br />";if(this._poiData.phone)a+="Tel.: "+this._poiData.phone+"<br />";if(this._poiData.url)a+='<a href="'+this._poiData.url+'" class="link_02" target="_blank" title="'+this._poiData.url+'" class="icon_01" rel="nofollow">mehr Infos</a>';if(this._poiData.logo)a+='<div class="iw_right w_100"><img src="'+this._poiData.logo+'" style="max-width:100px" /></div>';a+='<div class="h_001"></div>';return a};a.prototype.getTitle=function(){return this._poiData.count+1+". "+this._poiData.title};return a}(a.ToolTipInfoBox);a.PointOfInterestInfoBox=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(b){__extends(a,b);function a(e,f,d,c){var a=b.call(this,f,d,c)||this;a.index=e;return a}Object.defineProperty(a.prototype,"Index",{"get":function(){return this.index},enumerable:true,configurable:true});return a}(a.PushPin);a.PointOfInterestPushPin=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(c){var b=function(){function b(c,e,b,d){this.pushPinCollection=[];this.poiServiceCallPath="_virtualearth/common/poi/poiservices.asmx/GetResult";this.currentPage=1;this.controlIsActive=false;this.loadOnInitializing=true;this.cssClassAddonSelected="current";this.cssClassSlideHide="hide_slide";this.cssClassSlideShow="show_slide";this.cssClassSlideButtonOpened="icon-angle-left";this.cssClassSlideButtonClosed="icon-angle-right";this.cssClassMapAddonsOpened="mapContainerOpen";this.map=c;this.jq=e;this.globalVars=b;this.wnd=d;this.pushPinFactory=new a.PushPinFactory(this.map,this.globalVars);this.serviceUrl=this.globalVars.IWhost+this.poiServiceCallPath;this.center={latitude:this.globalVars.MapOptions.pinLat,longitude:this.globalVars.MapOptions.pinLon}}Object.defineProperty(b.prototype,"activationTrigger",{"get":function(){return this.$initialTrigger},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isActive",{"get":function(){return this.controlIsActive},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"loadPoisOnInitializing",{"get":function(){return this.loadOnInitializing},"set":function(a){this.loadOnInitializing=a},enumerable:true,configurable:true});b.prototype.initialize=function(){var a=this;this.$map=this.jq("#mapContainer");this.$initialTrigger=this.jq("#aPoiService");this.$poiMainSection=this.jq("#poiMainSection");if(!this.$poiMainSection.length)return;this.$poiSelectionPanel=this.jq("#poiSelection",this.$poiMainSection);this.$poiResultPanel=this.jq("#poiList",this.$poiMainSection);this.$poiCategoryDescription=this.jq("#mapPoiCategory",this.$poiResultPanel);this.$inputCustom=this.jq("#inputCustom",this.$poiMainSection);this.$inputCheckboxes=this.jq(".js-poicheckbox",this.$poiMainSection);this.$inputSelection=this.jq(".js-poicheckboxlabel",this.$poiMainSection);this.$btnClosePoi=this.jq("#aClosePoi",this.$poiMainSection);this.$btnBackToInput=this.jq("#mapPoiBackToInput",this.$poiMainSection);this.$divError=this.jq("#divErr",this.$poiMainSection);this.$divResult=this.jq("#divResultInner",this.$poiMainSection);this.$divPaging=this.jq("#divPaging",this.$poiMainSection);this.$poiLoader=this.jq("#imgPoiLoader,#loadingDiv",this.$poiResultPanel).hide();this.jq("#btnClearSearch",this.$poiMainSection).on("click",function(){a.clearResult()});this.$btnClosePoi.on("click",function(){if(a.$btnClosePoi.hasClass(a.cssClassSlideButtonOpened)){a.$poiMainSection.parent().removeClass(a.cssClassSlideShow).addClass(a.cssClassSlideHide);a.$btnClosePoi.removeClass(a.cssClassSlideButtonOpened).addClass(a.cssClassSlideButtonClosed);a.$map.removeClass(a.cssClassMapAddonsOpened)}else{a.$poiMainSection.parent().removeClass(a.cssClassSlideHide).addClass(a.cssClassSlideShow);a.$btnClosePoi.removeClass(a.cssClassSlideButtonClosed).addClass(a.cssClassSlideButtonOpened);a.$map.addClass(a.cssClassMapAddonsOpened)}});this.$inputCustom.on("keypress",function(b){if(b.keyCode!==13)return;b.preventDefault();a.currentPage=1;a.executeCustomSearch()});this.jq("#btnPoiCustom",this.$poiMainSection).on("click",function(b){b.preventDefault();a.currentPage=1;a.executeCustomSearch()});this.$inputCheckboxes.on("change",function(){a.executeFixedSearch()});this.$inputSelection.on("click",function(e){var c=a.jq(e.target);if(e.target.tagName.toLowerCase().match(/^(span|div)$/))c=c.prev();var f=c.parent().get(0),d=a.$inputCheckboxes.filter("[id="+f.htmlFor+"]");a.setCategoryButton(d,!d.is(":"+b.CHECKED_STATUS));a.currentPage=1});this.$btnBackToInput.on("click",function(b){b.preventDefault();a.$poiSelectionPanel.show();a.$poiResultPanel.hide()});this.loadOnInitializing&&this.onShow()};b.prototype.getMenueTitle=function(){return this.menueTitle};b.prototype.destroy=function(){this.clearResult();this.onHide()};b.prototype.onShow=function(){this.controlIsActive=true;this.$initialTrigger.addClass(this.cssClassAddonSelected);this.jq("#aCloseAddons").removeClass(this.cssClassAddonSelected);this.$poiMainSection.show().height(this.getHeight()).parent().show().removeClass(this.cssClassSlideHide).addClass(this.cssClassSlideShow);this.$btnClosePoi.show();this.$map.addClass(this.cssClassMapAddonsOpened);if(this.$inputCustom.val()!==""){this.executeCustomSearch();return}this.$inputCheckboxes.filter(":"+b.CHECKED_STATUS).length&&this.executeFixedSearch()};b.prototype.onHide=function(){this.controlIsActive=false;this.$initialTrigger.removeClass(this.cssClassAddonSelected);this.$poiMainSection.parent().removeClass(this.cssClassSlideShow).addClass(this.cssClassSlideHide);this.$btnClosePoi!=undefined&&this.$btnClosePoi.hide();this.$map.removeClass(this.cssClassMapAddonsOpened)};b.prototype.OpenCategory=function(c,a){this.currentPage=1;this.currentSearchValue=a;this.currentSearchVariant=b.SEARCHVARIANT_FIXED;this.setStatusForCheckboxes(":"+b.CHECKED_STATUS,false);this.setStatusForCheckboxes('[value="'+a+'"]',true);this.onShow();this.loadPushPins()};b.prototype.clearResult=function(){for(var a=0,c=this.pushPinCollection;a<c.length;a++){var d=c[a];this.map.removePushpin(d)}this.setStatusForCheckboxes(":"+b.CHECKED_STATUS,false);this.resultList=null;this.currentSearchValue="";this.currentSearchVariant="";this.currentPage=1;this.updateUserProfile()};b.prototype.setStatusForCheckboxes=function(d,c){var a=this;this.$inputCheckboxes.filter(d).each(function(e,d){a.jq(d).prop(b.CHECKED_STATUS,c);a.setCategoryButton(a.jq(d),c)})};b.prototype.setCategoryButton=function(b,c){var a=b.next().find("img");if(c)a.prop("src",a.prop("src").replace("_white.png",".png"));else a.prop("src",a.prop("src").replace(".png","_white.png"))};b.prototype.executeCustomSearch=function(){this.setStatusForCheckboxes(":"+b.CHECKED_STATUS,false);this.currentSearchValue=this.$inputCustom.val();this.currentSearchVariant=b.SEARCHVARIANT_CUSTOM;this.loadPushPins()};b.prototype.executeFixedSearch=function(){var c=this;this.$inputCustom.val("");var a=[];this.$inputCheckboxes.filter(":"+b.CHECKED_STATUS).each(function(d,b){a.push(c.jq(b).val())});this.currentSearchValue=a.join(",");this.currentSearchVariant=b.SEARCHVARIANT_FIXED;this.loadPushPins()};b.prototype.loadPushPins=function(){var a=this;if(!this.currentSearchValue){this.handleNoSearches();return}this.$divError.hide();this.$divResult.empty();this.$poiSelectionPanel.hide();this.$poiResultPanel.show().find("#imgPoiLoader").hide();this.$poiLoader.show();this.jq.ajax({type:"POST",url:this.serviceUrl,data:'{mediaId:"'+this.globalVars.MediaId+'",search:"'+this.currentSearchValue+'",searchVariant: "'+this.currentSearchVariant+'",lat:"'+this.center.latitude+'", lon:"'+this.center.longitude+'", page:"'+this.currentPage+'" }',contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){a.handleResult(b.d,a.currentSearchVariant)},error:function(b){b.statusText!=="abort"&&a.handleError()}});this.$poiCategoryDescription.text(this.getCategories());this.updateUserProfile()};b.prototype.handleResult=function(h,g){var a=this;this.resultList=this.jq.parseJSON(h);if(this.resultList==null)return;this.removePins();var e=0;this.pushPinCollection=[];this.$divResult.parent().scrollTop(0);for(var d=0,f=this.resultList.resultList;d<f.length;d++){var b=f[d];b.count=e;var c=this.pushPinFactory.GetPointOfInterestPushPin(b,g),i=this.getToolTipDescription(b,this.pushPinFactory.getPointOfInterestIcon(b.category,this.currentSearchVariant));this.pushPinCollection.push(c);this.map.addPushpin(c);this.$divResult.append(i);c.addListener("click",function(b){a.onPinClick(b)});e++}this.$poiLoader.hide();this.setPagingLinks(this.resultList.resultCount);this.resizePoiResult();this.map.fitBounds({pushpins:this.pushPinCollection},.001);this.map.hideInfoBox();this.jq(".js-poi-results",this.$poiResultPanel).on("click",function(d){var b=a.jq(d.target).closest(".js-poi-results"),e=b.data("index"),c=a.pushPinCollection[e];c.onClick();a.jq(".js-poi-results",a.$poiResultPanel).removeClass("active");b.addClass("active")})};b.prototype.onPinClick=function(c){var b=this.jq(".js-poi-results",this.$divResult),a=b.filter("[data-index="+c.Index+"]");if(!a.length)return;b.removeClass("active");a.addClass("active");var d=a.get(0).offsetTop;this.$divResult.parent().animate({scrollTop:d})};b.prototype.removePins=function(){var a=this;if(!this.pushPinCollection||!this.pushPinCollection.length)return;this.pushPinCollection.forEach(function(b){a.map.removePushpin(b)})};b.prototype.getHeight=function(){return Math.max(this.wnd.document.documentElement.clientHeight,this.wnd.innerHeight||0)-this.jq("#exposeMapMenu").outerHeight()};b.prototype.getToolTipDescription=function(a,c){if(!a)return null;var b="";b+=String.Format('<div class="poi-result-container js-poi-results" data-index="'+a.count+'">');b+=String.Format('<div class="margin_top_05 iw_left"><img src="'+c+'" /></div>');b+='<div class="poi-result-content">';if(a.title)b+=String.Format("<strong>"+(a.count+1)+". "+a.title+'</strong><div class="resultDistance">('+a.distance+" m)</div>");if(a.category)b+=String.Format('<div class="resultBranche"> Branche: '+a.category+"</div>");if(a.address||a.zip||a.city){b+='<div class="resultAddress">';if(a.address)b+=a.address+"<br />";if(a.city)b+=a.city;b+="</div>"}if(a.phone)b+=String.Format('<div class="resultPhone">Tel.: '+a.phone+"</div>");if(a.fax)b+=String.Format('<div class="resultFax">Fax: '+a.fax+"</div>");if(a.url)b+=String.Format('<a href="'+a.url+'" target="_blank" title="'+a.url+'" class="link_02" rel="nofollow">mehr Infos</a>');b+="</div></div>";return b};b.prototype.resizePoiResult=function(){var d=this.jq("#divResultOuter",this.$poiMainSection),c=this.getHeight(),a=123,b=this.$poiResultPanel.find("h4");if(b.length)a+=b.outerHeight();d.css({height:c-a})};b.prototype.getCategories=function(){var d=this;if(this.currentSearchVariant===b.SEARCHVARIANT_CUSTOM)return!this.$inputCustom.val()?"Stichwort":this.$inputCustom.val();var c=this.$inputCheckboxes.filter(":"+b.CHECKED_STATUS);if(c.length){var a=[];c.each(function(c,b){a.push(d.jq(b).data("name"))});return a.join(", ")}return""};b.prototype.setPagingLinks=function(d){var f=this;this.$divPaging.html("");if(d<=10)return;var e=d/10+1|0,c='<a href="#" class="js-poiPagingLink" data-page="{0}">{1}</a>&nbsp;|&nbsp;',g='<span class="current">{0}</span>&nbsp;|&nbsp;',b="";if(d%10===0)e=d/10|0;if(this.currentPage>1)b+=String.Format(c,(this.currentPage-1).toString(),"&laquo;");if(this.currentPage>7){b+=String.Format(c,"1","1");b+="...&nbsp;|&nbsp;";for(var h=this.currentPage+3,a=this.currentPage-3;a<=h;a++)if(this.currentPage===a)b+=String.Format(g,a.toString());else if(a<=e)b+=String.Format(c,a.toString(),a.toString())}else for(var a=1;a<=10;a++){if(e<a)break;if(this.currentPage===a)b+=String.Format(g,a.toString());else b+=String.Format(c,a.toString(),a.toString())}if(this.currentPage<e)b+=String.Format(c,(this.currentPage+1).toString(),"&raquo;");b=b.substr(0,b.length-7);this.$divPaging.append(b);this.jq(".js-poiPagingLink",this.$divPaging).on("click",function(a){f.currentPage=f.jq(a.target).data("page");f.loadPushPins()})};b.prototype.updateUserProfile=function(){this.jq.ajax({url:this.globalVars.IWhost+"expose/PoiChecked",method:"POST",data:'{ "type": "'+this.currentSearchVariant+'", "pois": "'+this.currentSearchValue+'" }',contentType:"application/json; charset=utf-8",dataType:"json"})};b.prototype.handleError=function(){this.$divResult.html("");this.$divPaging.html("");this.$divError.show().html("Fehler bei der Suchanfrage!");this.resultList=null;if(this.pushPinCollection&&this.pushPinCollection.length){for(var a=0,b=this.pushPinCollection;a<b.length;a++){var c=b[a];this.map.removePushpin(c)}this.pushPinCollection=[]}};b.prototype.handleNoSearches=function(){this.$divResult.empty();this.$divPaging.empty();this.resultList=null;if(this.pushPinCollection&&this.pushPinCollection.length){for(var a=0,c=this.pushPinCollection;a<c.length;a++){var d=c[a];this.map.removePushpin(d)}this.pushPinCollection=[]}this.currentSearchVariant===b.SEARCHVARIANT_CUSTOM&&this.$divError.show().html("Bitte wählen Sie eine Branche aus der Stichwortsuche oder geben Sie einen Suchbegriff in die Freitextsuche ein.")};b.CHECKED_STATUS="checked";b.SEARCHVARIANT_FIXED="fixed";b.SEARCHVARIANT_CUSTOM="custom";return b}();c.PointOfInterest=b})(b=a.Addon||(a.Addon={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(b){var c;(function(c){var b=function(){function b(b,d,a,c){this._slideButtonOpened="icon-angle-left";this._slideButtonClosed="icon-angle-right";this._slideShow="show_slide";this._slideHide="hide_slide";this._classAddonSelected="current";this._classAddonsOpened="mapContainerOpen";this._controlIsActive=false;this._map=b;this.Jq=d;this.GlobalVars=a;this.Wnd=c}b.prototype.initializeJQuerySelectors=function(){this.$map=this.Jq("#mapContainer");this.$menu=this.Jq("#exposeMapMenu");this.$mapRouteContainer=this.Jq("#mapRouteSection");this.$routeMenu=this.Jq("#mapRouteInput");this.$routeMenuButton=this.Jq("#aRouteService",this.$menu);this.$routeInputStart=this.Jq("#txtRouteStartAddress",this.$routeMenu);this.$routeEndAdress=this.Jq("#txtRouteEndAddress",this.$routeMenu);this.$routeGeoLocation=this.Jq("#aStartRouteGeolocation",this.$routeMenu);this.$routeCustomButton=this.Jq("#aStartRouteCustom",this.$routeMenu);this.$closeRouteButton=this.Jq("#aCloseRoute");this.$routeResultContainer=this.Jq("#mapRouteResult");this.$routeResult=this.Jq("#divRouteResult",this.$routeResultContainer);this.$routeModeSelectorButtons=this.Jq(".js-routeModeSelector",this.$routeMenu);this.$errorMessage=this.Jq("#errorRouteSummary",this.$routeMenu);this.$routeBackToInput=this.Jq("#mapRouteBackToInput")};Object.defineProperty(b.prototype,"activationTrigger",{"get":function(){return this.$routeMenuButton},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"isActive",{"get":function(){return this._controlIsActive},enumerable:true,configurable:true});b.prototype.initialize=function(){var b=this;this.initializeJQuerySelectors();this.$routeInputStart.keypress(function(a){return b.handleKeyEnter(a)});this.$routeCustomButton.on("click",function(){b.$errorMessage.hide();b.searchAndDisplayRoute()});this.$routeGeoLocation.on("click",function(){b.$errorMessage.hide();b.tryGetGeoLocation()});this.$routeModeSelectorButtons.on("click",function(a){b.$routeModeSelectorButtons.removeClass("current");b._routeMode=b.Jq(a.target).data("mode");b.Jq(a.target).addClass("current")});this.$closeRouteButton.hide().on("click",function(c){if(a.$(c.target).hasClass(b._slideButtonOpened)){b.$mapRouteContainer.parent().removeClass(b._slideShow).addClass(b._slideHide);a.$(c.target).removeClass(b._slideButtonOpened).addClass(b._slideButtonClosed);b.$map.removeClass(b._classAddonsOpened)}else{b.$mapRouteContainer.parent().removeClass(b._slideHide).addClass(b._slideShow);a.$(c.target).removeClass(b._slideButtonClosed).addClass(b._slideButtonOpened);b.$map.addClass(b._classAddonsOpened)}});this.$routeBackToInput.on("click",function(){b.displayRouteInput()});if(this.GlobalVars.MapOptions!==null&&this.GlobalVars.MapOptions.lat!==0&&this.GlobalVars.MapOptions.lon!==0)this._locationEndPos={lat:this.GlobalVars.MapOptions.lat,lng:this.GlobalVars.MapOptions.lon}};b.prototype.destroy=function(){this.onHide()};b.prototype.onShow=function(){this._controlIsActive=true;this.displayRouteSection()};b.prototype.onHide=function(){this._controlIsActive=false;this.$routeMenuButton.removeClass(this._classAddonSelected);this.$mapRouteContainer.hide().parent().removeClass(this._slideShow).addClass(this._slideHide);this._map.hideRoute();this.$closeRouteButton.hide();this.$map.removeClass(this._classAddonsOpened)};b.prototype.displayRouteSection=function(){this.$routeMenuButton.parent().find("a").removeClass(this._classAddonSelected);this.$routeMenuButton.addClass(this._classAddonSelected);this.$mapRouteContainer.show().height(this.getHeight()).parent().show().removeClass(this._slideHide).addClass(this._slideShow);this.$closeRouteButton.show().removeClass(this._slideButtonClosed).addClass(this._slideButtonOpened);this.$map.addClass(this._classAddonsOpened)};b.prototype.searchAndDisplayRoute=function(){var a={origin:this._geolocationPos!=undefined&&this._geolocationPos!=null?this._geolocationPos:this.$routeInputStart.val(),destination:this._locationEndPos!=undefined&&this._locationEndPos!=null?this._locationEndPos:this.$routeEndAdress.text().trim(),travelMode:this._routeMode!=undefined?this._routeMode.toUpperCase():"DRIVING"};if(a.origin!==""){this._map.calcAndDisplayRoute(this.$routeResult[0],a);this.displayResult();this._geolocationPos=null}else this.$errorMessage.show().html("Bitte geben Sie die Adresse des gewünschten Startpunktes ein!").slideDown()};b.prototype.displayResult=function(){this.$routeMenu.hide();this.$routeResultContainer.show()};b.prototype.displayRouteInput=function(){this.$routeMenu.show();this.$routeResultContainer.hide()};b.prototype.handleKeyEnter=function(b){if(b.keyCode===13){this.$errorMessage.hide();this.searchAndDisplayRoute();a.$.cancelEvent(b)}return true};b.prototype.tryGetGeoLocation=function(){var a=this;if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(b){a._geolocationPos={lat:b.coords.latitude,lng:b.coords.longitude};a.searchAndDisplayRoute()},function(){a.$errorMessage.show().html("Ihr Standort konnte nicht ermittelt werden. <br />Bitte geben Sie die Adresse des gewünschten Startpunktes ein!").slideDown()});else this.$errorMessage.show().html("Ihr Browser unterstützt die Standortbestimmung nicht. <br />Bitte geben Sie die Adresse des gewünschten Startpunktes ein!").slideDown()};b.prototype.getHeight=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)-this.$menu.outerHeight()};return b}();c.MapRoute=b})(c=b.Addon||(b.Addon={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var b=function(b){__extends(a,b);function a(c,d,e){var a=b.call(this,c)||this;a.earthRadius=6371;a.maskOuterCoordinatesLeftWorld=[{latitude:-90,longitude:0},{latitude:90,longitude:0},{latitude:90,longitude:-180},{latitude:-90,longitude:-180},{latitude:-90,longitude:0}];a.maskOuterCoordinatesRightWorld=[{latitude:-90,longitude:180},{latitude:90,longitude:180},{latitude:90,longitude:0},{latitude:-90,longitude:0},{latitude:-90,longitude:180}];!a.paths.length&&a.paths.push(a.GetCircleCoodinates(d,e));if(!a.paths.length)return a;if(a.IsClockwise(a.paths[0])){a.maskOuterCoordinatesRightWorld=a.maskOuterCoordinatesRightWorld.reverse();a.maskOuterCoordinatesLeftWorld=a.maskOuterCoordinatesLeftWorld.reverse()}a.paths.unshift(a.maskOuterCoordinatesRightWorld);a.paths.unshift(a.maskOuterCoordinatesLeftWorld);a.fillColor="#000000";a.fillOpacity=.3;a.strokeWeight=0;return a}a.prototype.GetCircleCoodinates=function(a,f){var d=[];if(f>0)for(var b=Math.PI/180,e=f/this.earthRadius/b,h=e/Math.cos(a.latitude*b),c=0;c<=360;c++){var g=c*b,i=a.latitude+e*Math.sin(g),j=a.longitude+h*Math.cos(g);d.push({latitude:i,longitude:j})}return d};a.prototype.IsClockwise=function(b){for(var c=0,a=0;a<b.length-1;a++)c+=b[a].latitude*b[a+1].longitude-b[a].longitude*b[a+1].latitude;return c/2<0};a.prototype.getCenterCoordinates=function(){for(var d,h,e,i,c=[],a=[],f,g,b=0;b<this.paths[2].length;b++){a.push(this.paths[2][b].longitude);c.push(this.paths[2][b].latitude)}c.sort();a.sort();d=a[0];h=c[this.paths[2].length-1];e=a[0];i=a[this.paths[2].length-1];f=d+(h-d)/2;g=e+(i-e)/2;return{latitude:g,longitude:f}};return a}(a.Polygon);a.PolygonMask=b})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(a){var b;(function(a){var g=function(){function a(){}return a}();a.RealEstatePushPinData=g;var d=function(){function a(){}return a}();a.RealEstatePushPinDataCollection=d;var e=function(){function a(){}return a}();a.PointOfInterestPushPinData=e;var c=function(){function a(){}return a}();a.PointOfInterestPushPinDataCollection=c;var f=function(){function a(){}return a}();a.ObjectColumboPushPinData=f;var b=function(){function a(){}return a}();a.ImmobilienMaklerPushPinDataCollection=b;var h=function(){function a(){}return a}();a.BrokersPushPinData=h})(b=a.DataContracts||(a.DataContracts={}))})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(b){var c=b.DataContracts.PushPin,d=b.DataContracts.PointOfInterestInfoBox,e=b.DataContracts.EstateOfferInfoBox,f=b.DataContracts.BrokersInfoBox,g=function(){function g(b,a){this._pointOfInteresetIcons=[{name:"apotheken",type:"map_poi_apotheke.png"},{name:"bäckereien",type:"map_poi_baecker.png"},{name:"backwaren",type:"map_poi_baecker.png"},{name:"konditoreien",type:"map_poi_baecker.png"},{name:"kindergärten",type:"map_poi_kindergarten.png"},{name:"fleischereien",type:"map_poi_metzger.png"},{name:"wurstwaren",type:"map_poi_metzger.png"},{name:"ärzt",type:"map_poi_arzt.png"},{name:"catering",type:"map_poi_gaststaette.png"},{name:"gaststätten",type:"map_poi_gaststaette.png"},{name:"restaurants",type:"map_poi_gaststaette.png"},{name:"lebensmittel",type:"map_poi_lebensmittel.png"},{name:"märkte",type:"map_poi_lebensmittel.png"},{name:"schulen",type:"map_poi_schule.png"},{name:"gymnasien",type:"map_poi_schule.png"}];this._map=b;this.GlobalVars=a;this._pinIconImagePath=this.GlobalVars.IWMediahost+"app_themes/global/images/maps/controlgifs/";this._pinPoiImagePath=this.GlobalVars.IWMediahost+"app_themes/global/images/maps/poi/"}g.prototype.GetRealEstatePushPin=function(b,g){var i=this,d=b.ids.map(function(a){return a.toString()}),f={latitude:Number(b.lat),longitude:Number(b.lon)},h=new e(this._map,d,g,f),a=new c(this._map,h,function(a,b,c){return i.getPinIcon(a,b,c)});a.position=f;a.isClustered=b.count>1;a.isRemembered=b.rem;a.guidList=d;a.icon=this.getPinIcon(a.isClustered,a.isRemembered,false);if(a.isClustered)a.label=b.count.toString();return a};g.prototype.GetSingleRealEstatePushPin=function(e,g,f){var h=this,d=new a.Map.DataContracts.ToolTipInfoBox(this._map,e);d.title=g;d.content=f;var b=new c(this._map,d,function(a,b,c){return h.getPinIcon(a,b,c)});b.position=e;b.icon=this.getPinIcon(b.isClustered,b.isRemembered,false);return b};g.prototype.GetBrokersPushPin=function(b,g){var i=this,d=b.guid,e={latitude:Number(b.lat),longitude:Number(b.lon)},h=new f(this._map,d,g,e),a=new c(this._map,h,function(a,b,c){return i.getPinIcon(a,b,c)});a.position=e;a.isClustered=b.count>1;a.guidList=d;a.icon=this.getPinIcon(a.isClustered,a.isRemembered,false);if(a.isClustered)a.label=b.count.toString();return a};g.prototype.GetPointOfInterestPushPin=function(a,f){var g={latitude:Number(a.lat),longitude:Number(a.lon)},e=this.getPointOfInterestIcon(a.category,f),h=new d(this._map,a,e,g),c=new b.DataContracts.PointOfInterestPushPin(a.count,this._map,h);c.position={latitude:a.lat,longitude:a.lon};c.icon=e;return c};g.prototype.GetObjectColumboPushPin=function(b){var a=new c(this._map);a.position={latitude:b.lat,longitude:b.lon};a.icon=this.getObjectColumboIcon();return a};g.prototype.GetSinglePushPin=function(b){var a=new c(this._map,null);a.position=b;a.icon=this.getPinIcon(a.isClustered,a.isRemembered,false);return a};g.prototype.getPinIcon=function(b,c,a){return b?this._pinIconImagePath+(a?"pin_multi_highlight.png":"pin_multi.png"):c?this._pinIconImagePath+(a?"pin_rem_highlight.png":"pin_rem.png"):this._pinIconImagePath+(a?"pin_map_highlight.png":"pin_map.png")};g.prototype.getPointOfInterestIcon=function(a,c){a=a.toLowerCase();if(c=="custom")return this._pinPoiImagePath+"map_poi_default.png";var b=this._pointOfInteresetIcons.filter(function(b){return a.indexOf(b.name)>-1})[0];return b!=undefined?this._pinPoiImagePath+b.type:this._pinPoiImagePath+"map_poi_default.png"};g.prototype.getObjectColumboIcon=function(){return this.GlobalVars.IWMediahost+"app_themes/mid_0_rwd/image/icon/icon_objektcolumbo_map_pin.png"};return g}();b.PushPinFactory=g})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(b){var a=function(){function a(a,b){this.addons=[];this._jq=b;this._map=a}a.prototype.addAddon=function(a){var b=this;a.initialize();a.activationTrigger.on("click",{currentControl:a},function(a){b.onTriggerClick(a)});this.addons.push(a)};a.prototype.onTriggerClick=function(b){var a=b.data.currentControl;this.addons.filter(function(b){return b!==a}).forEach(function(b){b.onHide(!a.isActive)});if(a.isActive)a.onHide(true);else{this._map.hideInfoBox();a.onShow()}};return a}();b.MapView=a})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(c){var b=function(){function b(d,c,b,a){this.mapLoadedCallbacks=[];this._wnd=d;this._globalVars=c;this.mapId=b;this.mapKeyProvider=a;this._mapOptions={center:{latitude:this._globalVars.MapOptions.lat,longitude:this._globalVars.MapOptions.lon},zoom:this._globalVars.MapOptions.zoom};if(this._globalVars.MapOptions.draggable===false)this._mapOptions.draggable=false}b.prototype.SetMapGestureHandling=function(a){this._mapOptions.gestureHandling=a};b.prototype.LoadMap=function(){var b=this,c=new a.Map.Google.GoogleMapLoader(this._wnd,this._globalVars,this.mapKeyProvider);c.addOnMapSourceLoadedCallback(function(a){b.mapKey=a;b.mapLoadedCallbacks.forEach(function(a){return a(b.Map)})});c.loadMap()};b.prototype.addOnMapLoadedCallback=function(a){this.mapLoadedCallbacks.push(a)};Object.defineProperty(b.prototype,"Map",{"get":function(){if(!this._map)this._map=new a.Map.Google.GoogleMap(this.mapId,this._mapOptions,this.mapKey);return this._map},enumerable:true,configurable:true});Object.defineProperty(b.prototype,"MapService",{"get":function(){if(!this._mapServices)this._mapServices=new a.Map.Google.GoogleMapServices;return this._mapServices},enumerable:true,configurable:true});return b}();c.MapFactory=b})(b=a.Map||(a.Map={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(b){var c=function(c){__extends(b,c);function b(){var a=c.call(this)||this;a.pushPinsEstate=[];a.mapIsLoaded=false;a.loadPoiSelection=false;return a}b.prototype.OnDocumentReady=function(d,a,b){c.prototype.OnDocumentReady.call(this,d,a,b);this.mapOptions=a.MapOptions;this.locationPinAllowed=this.mapOptions.showPin;this.initialCoordinates={latitude:this.mapOptions.pinLat,longitude:this.mapOptions.pinLon};this.initialZoom=this.mapOptions.zoom;this.initialize()};b.prototype.initialize=function(){var a=this;this.$exposeMapContainer=this.Jq("#mapOverlay");this.$mapLoadScreen=this.Jq("#mapLoadScreen");this.$Lageinfo=this.Jq("#divLageinfos");this.$exposeMap=this.Jq("#exposeMap",this.$Lageinfo);this.$aMapOpener=this.Jq(".js-aKarte");this.$aCloseMap=this.Jq("#aCloseMap");this.$aPoiOpener=this.Jq(".js-poiOpener");this.$aPoiSelector=this.Jq(".js-poiSelector");this.$aRouteSelector=this.Jq(".js-aRouteService");this.$divContact=this.Jq("#divContact");this.$aCloseMap.on("click",function(b){b.preventDefault();a.closeMap()});this.$aMapOpener.on("click",function(b){b.preventDefault();a.openMap()});this.$mapLoadScreen.on("click",function(){a.$mapLoadScreen.hide();a.closeMap()});this.$aPoiSelector.on("click",function(b){b.preventDefault();a.loadPoiSelection=true;var d=a.Jq(b.target).data("name"),c=a.Jq(b.target).data("value");a.openMap();if(!a.mapIsLoaded)a.mapFactory.addOnMapLoadedCallback(function(){a.poiAddon.OpenCategory(d,c)});else a.poiAddon.OpenCategory(d,c)});this.$aRouteSelector.on("click",function(b){b.preventDefault();a.openMap();if(!a.mapIsLoaded)a.mapFactory.addOnMapLoadedCallback(function(){a.routeAddon.onShow()});else a.routeAddon.onShow()});this.$aPoiOpener.on("click",function(b){b.preventDefault();a.loadPoiSelection=true;a.openMap()})};b.prototype.openMap=function(){if(!this.map){this.$mapLoadScreen.show();this.loadMap();return}this.displayMap()};b.prototype.loadMap=function(){var b=this;this.mapFactory=new a.Map.MapFactory(this.Wnd,this.GlobalVars,"exposeMap",this.getMapKey());this.mapFactory.addOnMapLoadedCallback(function(a){b.mapLoaded(a)});this.mapFactory.SetMapGestureHandling(a.Map.DataContracts.MapGestureHandling.fullcontrolled);this.mapFactory.LoadMap()};b.prototype.mapLoaded=function(c){var b=this;this.mapIsLoaded=true;this.map=c;this.mapView=new a.Map.MapView(this.map,this.Jq);this.displayMap();this.renderBackToObjectButton();if(this.locationPinAllowed){this.pushPinFactory=new a.Map.PushPinFactory(this.map,this.GlobalVars);this.loadEstatePushPin()}this.poiAddon=new a.Map.Addon.PointOfInterest(this.map,this.Jq,this.GlobalVars,this.Wnd);this.poiAddon.loadPoisOnInitializing=this.loadPoiSelection;this.mapView.addAddon(this.poiAddon);this.Jq("#aCloseAddons").on("click",function(a){b.poiAddon.destroy();b.routeAddon.destroy();b.Jq(a.target).addClass("current")});if(this.locationPinAllowed){this.routeAddon=new a.Map.Addon.MapRoute(this.map,this.Jq,this.GlobalVars,this.Wnd);this.mapView.addAddon(this.routeAddon)}};b.prototype.getMapKey=function(){var a=this,b="/expose/getmapkey";if(this.GlobalVars.MapKeySrv)b=this.GlobalVars.MapKeySrv;return this.Jq.Deferred(function(c){a.Jq.ajax({type:"POST",url:b,dataType:"text",headers:{accept:"text/plain"},data:{type:"google"},success:function(e,g,f){var b=e,d=f.getResponseHeader("content-type");if(d&&d.indexOf("xml")>-1)b=a.Jq(e).text().trim();if(b!=="")c.resolve(b);else c.reject()}})})};b.prototype.loadEstatePushPin=function(){var a={latitude:this.mapOptions.pinLat,longitude:this.mapOptions.pinLon},d="Standort der Immobilie",c=this.mapOptions.street+"<br />"+this.mapOptions.address,b=this.pushPinFactory.GetSingleRealEstatePushPin(a,d,c);this.map.addPushpin(b);this.map.showInfobox(b.infoBox,a)};b.prototype.closeMap=function(){this.$exposeMapContainer.hide("fast");this.Jq("#IwAGMain").removeClass("map_open");this.map.hideInfoBox();this.poiAddon.onHide();this.poiAddon.destroy()};b.prototype.loadEstatePushPins=function(){var a=this;this.Jq.get("/liste/karte/getpindata?"+this.GlobalVars.filterquery).done(function(b){a.onLoadEstatePinDataComplete(b)})};b.prototype.onLoadEstatePinDataComplete=function(a){if(!a||!a.cnt||a.obj.length<=0)return;for(var b=0,c=a.obj;b<c.length;b++){var d=c[b];this.pushPinsEstate.push(this.pushPinFactory.GetRealEstatePushPin(d,"/liste/karte/getinfo"))}};b.prototype.displayMap=function(){this.Jq("#IwAGMain").addClass("map_open");this.$exposeMap.show();this.$exposeMapContainer.show();!this.locationPinAllowed&&this.showInfoBoxNoLocation();this.$mapLoadScreen.hide()};b.prototype.showInfoBoxNoLocation=function(){var e=this,c=[],d=new a.Map.DataContracts.InfoBoxButton("aContactNoLocation","btn_01 ci_color","Anbieter kontaktieren",function(){return e.openAndShowContact()});c.push(d);var b=new a.Map.DataContracts.InfoBoxWithButton(this.map,c);b.title="";b.content="Den genauen Standort der Immobilie erfahren Sie vom Anbieter.";this.map.showInfobox(b,this.map.getCenterCoordinates())};b.prototype.openAndShowContact=function(){this.$exposeMapContainer.hide("fast");this.Jq("body").css({overflow:"auto"});a.Expose.getInstance().DisplayContactNoLocation()};b.prototype.returnToObject=function(){this.map.hideInfoBox();this.map.setOptions({zoom:this.initialZoom,center:this.initialCoordinates});!this.locationPinAllowed&&this.showInfoBoxNoLocation()};b.prototype.renderBackToObjectButton=function(){var b=this,a=document.createElement("div");a.id="aToObject";a.className="backtolocation";this.$exposeMap.append(a);this.$aToObject=this.Jq("#aToObject");this.$aToObject.on("click",function(){b.returnToObject()})};return b}(a.BaseClass);b.Karte=c;a.Container.RegisterObserver(new a.Expose.Karte)})(b=a.Expose||(a.Expose={}))})(IwAG||(IwAG={}));var IwAG;(function(a){var b;(function(c){var b=function(c){__extends(b,c);function b(b){var a=c.call(this)||this;a.$window=null;a.listImages=null;a.listEquipment=null;a.scrollTopAnchor=null;a.lastY=0;a.resizeTimer=0;a.cssHiddenClass="inactive";a.Wnd=b;a.initialize();a.Wnd.addEventListener("load",function(){a.LazyLoadImages()});return a}b.prototype.OnDocumentReady=function(d,a,b){c.prototype.OnDocumentReady.call(this,d,a,b);this.$window=this.Jq(this.Wnd);this.scrollTopAnchor=this.Jq("#scrollTopAnchor");this.bindEvents();this.positionDistanceLabel()};b.prototype.initialize=function(){this.listImages=this.Wnd.document.getElementsByClassName("js_listimage");this.listEquipment=this.Wnd.document.getElementsByClassName("js-EqList");this.buildEquipmentTags();this.setMultilineForTextRows(this.Wnd.document.getElementsByClassName("js-premiumTitle"));this.setMultilineForTextRows(this.Wnd.document.getElementsByClassName("js-companyName"));this.BindImageResize()};b.prototype.bindEvents=function(){var a=this;this.Jq(this.Wnd.document).on("ShowMerkenInfo",function(c,b){a.showMerkenInfo(b)}).on("HideMerkenInfo",function(c,b){a.hideMerkenInfo(b)}).on("ResizeListImages",function(){a.initialize();a.LazyLoadImages()});this.$window.trigger("disableFixedHeader");if(this.$window.width()<=640){this.scrollTopAnchor.hide();this.$window.on("scroll",function(){a.onScroll()})}this.scrollTopAnchor.on("click",function(b){a.Jq("html, body").animate({scrollTop:0},"slow");b.preventDefault()});this.Jq(this.Wnd).on("resize",function(){a.resizeTimer&&a.Wnd.clearTimeout(a.resizeTimer);a.resizeTimer=a.Wnd.setTimeout(function(){a.buildEquipmentTags()},50)}).on("skyscraperRendered",function(){a.buildEquipmentTags()}).on("listimage.resize",function(c,b){a.resizeImage(b)})};b.prototype.LazyLoadImages=function(){for(var a,d,b="data-srcset",e=0,h=this.listImages.length;e<h;e++){a=this.listImages[e];if(a.hasAttribute(b)){a.setAttribute("srcset",a.getAttribute(b));a.setAttribute("src",this.getSingleUrl(a.getAttribute(b)));var c=a.parentElement.getElementsByTagName("source");if(c&&c.length)for(var f=0,g=c.length;f<g;f++){d=c[f];d.hasAttribute(b)&&d.setAttribute("srcset",d.getAttribute(b))}}}typeof picturefill!=="undefined"&&picturefill({elements:this.listImages,reevaluate:true})};b.prototype.BindImageResize=function(){for(var c=this,d=function(){var d=a.listImages[b];if(a.isImageComplete(d))a.resizeImage(d);else if(d.addEventListener)d.addEventListener("load",function(){c.resizeImage(d)});else d.attachEvent("onload",function(){c.resizeImage(d)})},a=this,b=0;b<this.listImages.length;b++)d()};b.prototype.getSingleUrl=function(a){return!a?"":a.indexOf(",")<0?a:a.substr(0,a.indexOf(" "))};b.prototype.showMerkenInfo=function(a){this.Jq("#remember-"+a).fadeIn(400).delay(1e3).fadeOut(1e3)};b.prototype.hideMerkenInfo=function(a){this.Jq("#remember-"+a).hide()};b.prototype.onScroll=function(){var a=this.Wnd.pageYOffset;if(this.lastY>a)if(a>2*this.$window.height())this.scrollTopAnchor.show();else this.scrollTopAnchor.hide();else this.scrollTopAnchor.hide();this.lastY=a};b.prototype.buildEquipmentTags=function(){for(var l="js-moreTag",k=0,r=this.listEquipment.length;k<r;k++){var a=this.listEquipment[k],h=a.getElementsByClassName(l);h&&h.length&&a.removeChild(h[0]);var d=a.children,f=d.length;if(f===0)continue;for(var p=a.clientWidth,c=[],e=[],m=50,i=d[0].tagName,g=d[0].classList,j=0;j<d.length;j++){var b=d[j];if(b.classList)b.classList.contains(this.cssHiddenClass)&&b.classList.remove(this.cssHiddenClass);else if(b.className)b.className.indexOf(this.cssHiddenClass)>-1&&b.className.replace(this.cssHiddenClass,"");var q=this.getElementsWidth(b);m+=q;if(m<p)c.push(b);else e.push(b)}while(a.firstChild)a.removeChild(a.firstChild);for(var n in c){if(!c.hasOwnProperty(n))continue;this.addEquipmentItem(a,i,c[n].textContent,g)}for(var o in e){if(!e.hasOwnProperty(o))continue;this.addEquipmentItem(a,i,e[o].textContent,g,this.cssHiddenClass)}f>c.length&&this.addEquipmentItem(a,i,"+"+(f-c.length).toString(),g,l)}};b.prototype.positionDistanceLabel=function(){for(var b=this.Wnd.document.getElementsByClassName("distance"),a=0;a<b.length;a++)this.Jq(b[a]).text().trim().length>10&&this.Jq(b[a].parentElement).css("padding-right",+this.Jq(b[a]).outerWidth(true)+20+"px")};b.prototype.addEquipmentItem=function(g,e,f,b,d){var a=this.Wnd.document.createElement(e);if(b){var c=0;while(c<b.length){a.classList.add(b[c]);c++}}d&&a.classList.add(d);a.textContent=f;g.appendChild(a)};b.prototype.getElementsWidth=function(b){var a=this.Wnd.getComputedStyle?this.Wnd.getComputedStyle(b,null):b.style,f=parseInt(a.marginLeft)||0,d=parseInt(a.marginRight)||0,e=parseInt(a.borderLeftWidth)||0,c=parseInt(a.borderRightWidth)||0;return e+f+b.clientWidth+d+c};b.prototype.resizeImage=function(a){a.style.width="100%";a.style.height="100%";var f=a.naturalWidth||a.clientWidth,d=a.naturalHeight||a.clientHeight,b=a.parentElement;if(b.tagName.toUpperCase()!=="DIV")b=b.parentElement;var e=b.clientWidth,c=b.clientHeight,k=d/f,j=c/e;if(k>=j){a.style.height="auto";var i=e/f,g=(c-i*d)/2;a.style.margin=g+"px 0"}else{a.style.width="auto";var h=c/d,g=(e-h*f)/2;a.style.margin="0 "+g+"px"}};b.prototype.isImageComplete=function(a){var b=a.complete;if(!a.naturalWidth&&!a.clientWidth)b=false;if(!a.naturalHeight&&!a.clientHeight)b=false;return b};b.prototype.setMultilineForTextRows=function(c){if(!c||!c.length)return;for(var e=/(safari|chrome)/.test(this.Wnd.navigator.userAgent.toLowerCase()),d=0,f=c.length;d<f;d++){var b=c[d];if(b.classList)if(e&&a.Vars.DeviceType==="desktop")b.classList.add("premiumTitle_ellipsisWebkit");else b.classList.add("ellipsis");else if(b.className)if(e&&a.Vars.DeviceType==="desktop")b.className=b.className+" premiumTitle_ellipsisWebkit";else b.className=b.className+" ellipsis"}};return b}(a.BaseClass);c.ListBase=b;a.Container.RegisterObserver(new b(window))})(b=a.List||(a.List={}))})(IwAG||(IwAG={}))