var ErrorLogging=function(){function a(a){this.TestSystem=false;this.LinkToErrorController="/mvcroot/logging/logerror";this.window=a;this.lastError="";this.fields={message:"clientErrorMessage",url:"clientErrorUrl",row:"clientErrorLine",col:"clientErrorColumn",stack:"clientStacktrace"}}a.prototype.ErrorHandler=function(e,f,i,j,l){if(!this.isValidFile(f))return;if(!this.isValidBrowser())return;if(!this.isValidErrorMessage(e))return;this.TestSystem&&this.window.alert('JavaScript Fehler in "'+f+'" Zeile '+i+" Spalte "+j+": "+e);var g=this.window.document.getElementsByTagName("body")[0];if(!g)return;var d=this.getStackTrace(l);if(this.isErrorAlreadyLogged(d))return;var h=this.getOrCreateForm("frmErrorLogging",g);for(var k in this.fields){var a=this.getOrCreateElement(this.fields[k],h);switch(k){case"message":a.value=e;break;case"url":a.value=f;break;case"row":a.value=(i||1).toString();break;case"col":a.value=(j||0).toString();break;case"stack":if(d){var b=d.join("\n");if(b.length>8e3)b=b.substr(0,8e3);a.value=b}}}var c=this.createAjaxObject();if(!c)return;c.open("POST",this.LinkToErrorController,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.send(this.serialize(h))};a.prototype.serialize=function(c){var f=this;if(!c||!c.nodeName||c.nodeName.toLowerCase()!=="form")return"";for(var e=0,d,i=c.elements.length,g,a,h=[],b=function(b,a){h.push(f.urlencode(b)+"="+f.urlencode(a))};e<i;e++){a=c.elements[e];if(a.name===""||a.disabled)continue;switch(a.nodeName.toLowerCase()){case"input":switch(a.type){case"text":case"hidden":case"password":case"button":case"submit":b(a.name,a.value);break;case"checkbox":case"radio":a.checked&&b(a.name,a.value)}break;case"textarea":b(a.name,a.value);break;case"select":switch(a.type){case"select-one":b(a.name,a.value);break;case"select-multiple":for(d=0,g=a.options.length;d<g;d++)a.options[d].selected&&b(a.name,a.options[d].value)}break;case"button":switch(a.type){case"reset":case"submit":case"button":b(a.name,a.value)}}}return h.join("&")};a.prototype.urlencode=function(a){return encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+").replace(/%3C/g,"%5B").replace(/%3E/g,"%5D")};a.prototype.createAjaxObject=function(){var a=null;if(typeof XMLHttpRequest!=="undefined")a=new XMLHttpRequest;else if(typeof ActiveXObject!=="undefined")try{a=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}}return a};a.prototype.isErrorAlreadyLogged=function(a){if(!a||a.length<=0)return false;var b=a[0]+"\n";if(this.lastError.indexOf(b)>=0)return true;this.lastError+=b;return false};a.prototype.isValidFile=function(a){return a&&(a.toLowerCase().indexOf(this.window.location.host)>=0||a.toLowerCase().indexOf("/_")===0)};a.prototype.isValidBrowser=function(){var a=this.window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.toLocaleLowerCase().indexOf("googlebot");return b>0&&parseInt(a.substring(b+5,a.indexOf(".",b)),10)<8?false:c>-1?false:true};a.prototype.isValidErrorMessage=function(b){if(!b)return false;var a=b.toLocaleLowerCase();return a.indexOf('"jquery" ist undefiniert')>-1?false:a.indexOf("jquery is not defined")>-1?false:a.indexOf("$ is not a function")>-1?false:a.indexOf("iwag.$ not present")>-1?false:a.indexOf("securityerror")>-1?false:a==="script error"?false:a.indexOf("carousel")>-1&&a.indexOf("uncaught can not detect viewport width")>-1?false:true};a.prototype.getOrCreateForm=function(b,c){var a=this.window.document.getElementById(b);if(!a){a=this.window.document.createElement("form");a.setAttribute("id",b);a.setAttribute("method","POST");c.appendChild(a)}return a};a.prototype.getOrCreateElement=function(b,c){var a=this.window.document.getElementById(b);if(!a){a=this.window.document.createElement("input");a.setAttribute("id",b);a.setAttribute("name",b);a.setAttribute("type","hidden");c.appendChild(a)}return a};a.prototype.getStackTrace=function(d){var f=[],g=false;if(d&&d.stack){for(var c=d.stack.split("\n"),i=c.length,a=0;a<i;a++)f.push(c[a]);g=true}else if(d&&d.message){for(var c=d.message.split("\n"),i=c.length,h=void 0,a=0;a<i;a++){h=c[a];if(c[a+1]){h+=" at "+c[a+1];a++}f.push(h)}g=true}if(!g){var e=arguments.callee.caller,j=void 0,b=void 0;while(e){j=e.toString();b=j||"anonymous";if(b.indexOf("OnErrorEvent")<0){if(b.length>1e3)b=b.substr(0,1e3)+"...//*truncated*//}";f.push(b)}e=e.caller}}return f};return a}();(function(b){var a=new ErrorLogging(b);if(typeof IwAG!=="undefined"&&typeof IwAG.Vars!=="undefined"){if(IwAG.Vars.TestSystem!=undefined)a.TestSystem=IwAG.Vars.TestSystem;if(IwAG.Vars.LinkToErrorController!=undefined)a.LinkToErrorController=IwAG.Vars.LinkToErrorController}if(b.addEventListener)b.addEventListener("error",function(b){a.ErrorHandler(b.message,b.filename,b.lineno,b.colno,b.error)});else b.onerror=a.ErrorHandler})(this)